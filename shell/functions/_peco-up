function _peco-up() {
    local current
    local rootdir
    current=$(dirname $PWD)
    rootdir=$(git rev-parse --show-toplevel 2>/dev/null)
    if [[ "$rootdir" == "" ]]; then
        rootdir="/"
    fi

    local -a dirs
    while [[ "$current" != "$rootdir" ]]
    do
        dirs=($dirs $current)
        current=$(dirname $current)
    done
    dirs=($dirs $rootdir)

    local dir
    dir=$(echo ${(j:\n:)dirs} | peco)
    cd $dir
}
